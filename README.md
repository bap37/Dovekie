Original code comes from https://arxiv.org/abs/2112.03864

This is the cleaned, somewhat upgraded version. Still very WIP. More to come here.
